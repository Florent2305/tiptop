# @configure_input@

package = @PACKAGE_NAME@
version = @PACKAGE_VERSION@
tarname = @PACKAGE_TARNAME@
distdir = $(tarname)-$(version)

prefix      = @prefix@
exec_prefix = @exec_prefix@
bindir      = @bindir@
datarootdir = @datarootdir@
mandir      = @mandir@
man1dir     = $(mandir)/man1

# VPATH-specific substitution variables
srcdir= @srcdir@
VPATH = @srcdir@





# Define one of the TARGET_xxx or NOTARGET
# TARGET=-DNOTARGET
TARGET=-DTARGET_X86

# If building on a Linux 2.6.31, add -DKERNEL31
CFLAGS=-O2 -Wall $(TARGET) -DHAS_CURSES
LDFLAGS=-O2 -lcurses

CFLAGS+=$(XCFLAGS)
LDFLAGS+=$(XLDFLAGS)

OBJS=tiptop.o pmc.o process.o requisite.o conf.o screen.o \
     debug.o version.o helpwin.o options.o hash.o spawn.o \
     screens-intel.o


all: tiptop

tiptop: $(OBJS)
	$(CC) -o tiptop $(OBJS) $(LDFLAGS)


Makefile: Makefile.in ../config.status
	cd .. && ./config.status src/$@

../config.status: ../configure
	cd .. && ./config.status --recheck



version.o: version.c
	$(CC) $(CFLAGS) -DCOMPILE_HOST="\""`hostname`"\"" \
                        -DCOMPILE_DATE="\"`date`\"" \
                        -c $(srcdir)/version.c

install:
	install -d $(DESTDIR)$(bindir)
	install -m 0755 tiptop $(DESTDIR)$(bindir)
	install -d $(DESTDIR)$(man1dir)
	install -m 0644 tiptop.1 $(DESTDIR)$(man1dir)

uninstall:
	-rm $(DESTDIR)$(bindir)/tiptop
	-rm $(DESTDIR)$(man1dir)/tiptop.1

clean:
	/bin/rm -f $(OBJS) tiptop


depend:
	makedepend -Y -DDEBUG $(TARGET) -DHAS_CURSES *.c


.PHONY: all clean depend install uninstall


# DO NOT DELETE

conf.o: conf.h options.h
debug.o: debug.h options.h
hash.o: hash.h process.h screen.h options.h
helpwin.o: helpwin.h screen.h options.h
options.o: options.h version.h
pmc.o: pmc.h
process.o: hash.h process.h screen.h options.h pmc.h spawn.h utils.h
requisite.o: pmc.h requisite.h
screen.o: options.h screen.h
screens-intel.o: screen.h options.h screens-intel.h
spawn.o: options.h process.h screen.h
tiptop.o: conf.h options.h helpwin.h screen.h pmc.h process.h requisite.h
tiptop.o: spawn.h
utils.o: debug.h utils.h
version.o: version.h
